pico-8 cartridge // http://www.pico-8.com
version 42
__lua__
function _init()
	player = {
		 x = 2,
		 y = 2
		}
end
 	
function _update()
	if btn(0) then
	 player.x -= 1
	elseif btn(1) then
		player.x += 1
	end
	if btn(2) then
		player.y -= 1
	elseif btn(3) then
		player.y += 1
	end
end

function _draw()
 cls()
 map(0, 0, 0, 0, 15, 15)
 local col = 11
 if has_wall(player.x, player.y, 1) then
 	col = 8
 end
 print(player.x..":"..player.y, 100, 1)
 print(world_to_map(player.x)..":"..world_to_map(player.y), 100, 20)
 circfill(player.x, player.y, 1, col)
end

function world_to_map(coordinate) 
 return ceil(coordinate / 8) - 1
end

function has_wall(world_x, world_y, range)
	local map_x = world_to_map(world_x)
	local map_y = world_to_map(world_y)
	for x=map_x - range, map_x + range do
		for y=map_y - range, map_y + range do
			if mget(x, y) == 4 then
				return true
			end
		end
	end
	
	return false
end
__gfx__
00000000000000000000000000000000222222220000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000007770000070700000070000222222220000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700007770000077700000777000222222220000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000700000007000000070000222222220000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000007770000077700000777000222222220000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700070707000707070007070700222222220000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000700000007000000070000222222220000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000007070000070700000707000222222220000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0404040404040404040404040404040404000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0400000000000000000000000000000404000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0400000000000000000000000000000404000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0400000000000000000000000400000404000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0400000400000000000000040404000404000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0400000400000000000000000400000404000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0400040404000000000000000000000404000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0400000000000000000000000000000404000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0400000400000004040400000000000404000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0400000004000000000004040000000404000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0400000000000000000000000400000404000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0400000000000000000000040400000404000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0400000000000000000000000000000404000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0400000000000000000000000000000404000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0400000004040000000000000000000404000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0404040404040404040404040404040404000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0404040404040404040404040404040404000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
